<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.8" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <title>最低成本的方式搭建ChatGpt接口 | 不良人</title><meta name="description" content="My first VuePress Site">
    <link rel="preload" href="/assets/style-BV2aNBet.css" as="style"><link rel="stylesheet" href="/assets/style-BV2aNBet.css">
    <link rel="modulepreload" href="/assets/app-C2hHG5A5.js"><link rel="modulepreload" href="/assets/最低成本的方式搭建ChatGpt接口.html-DxOt7mel.js">
    <link rel="prefetch" href="/assets/get-started.html-Bo8AScPC.js" as="script"><link rel="prefetch" href="/assets/index.html-9Q8ZY1j3.js" as="script"><link rel="prefetch" href="/assets/C__实现微信自动跳一跳.html-CcFQ_9H2.js" as="script"><link rel="prefetch" href="/assets/C__手撸信号槽.html-Bv4cEsDL.js" as="script"><link rel="prefetch" href="/assets/C__调用JS代码.html-BCS5ThZI.js" as="script"><link rel="prefetch" href="/assets/CloudFlare以及防DDOS策略详述.html-AQ4Br6oj.js" as="script"><link rel="prefetch" href="/assets/Direct3D9入门绘制.html-BIGSbPmu.js" as="script"><link rel="prefetch" href="/assets/Dll调用内存bug解决.html-BZ_txKXP.js" as="script"><link rel="prefetch" href="/assets/NDK开发so调用so.html-DoF0r0RW.js" as="script"><link rel="prefetch" href="/assets/Onnxruntime Without Opencv.html-D5lk-eJs.js" as="script"><link rel="prefetch" href="/assets/OpenCv_CUDA实现Gpu加速.html-BJ4VNr7d.js" as="script"><link rel="prefetch" href="/assets/Surface使用体验与RD_frp搭建.html-PLfoR8AL.js" as="script"><link rel="prefetch" href="/assets/TinyWebServer手撸记录.html-Nlp3WE3J.js" as="script"><link rel="prefetch" href="/assets/X职通APP算法破解记录.html-B4Gm4m3M.js" as="script"><link rel="prefetch" href="/assets/内层CALL追局部变量.html-C2orpl5S.js" as="script"><link rel="prefetch" href="/assets/当Yolo成为外挂.html-DZon-09R.js" as="script"><link rel="prefetch" href="/assets/微信小程序逆向教程.html-BFV3Meaf.js" as="script"><link rel="prefetch" href="/assets/手机浏览器调试方法.html-DICYDD4M.js" as="script"><link rel="prefetch" href="/assets/指定窗口句柄截图.html-_1HHPYs3.js" as="script"><link rel="prefetch" href="/assets/某付费文档网破解记录.html-dkf4pa1N.js" as="script"><link rel="prefetch" href="/assets/栈溢出漏洞分析.html-BlZPFWeS.js" as="script"><link rel="prefetch" href="/assets/网游喊话加密Call分析.html-DA16om2c.js" as="script"><link rel="prefetch" href="/assets/网游链表数据遍历.html-CpYGdT1a.js" as="script"><link rel="prefetch" href="/assets/index.html-CPuk-ezE.js" as="script"><link rel="prefetch" href="/assets/index.html-zDyTQ9uS.js" as="script"><link rel="prefetch" href="/assets/index.html-b8DRJuQa.js" as="script"><link rel="prefetch" href="/assets/index.html-B_rIAD30.js" as="script"><link rel="prefetch" href="/assets/《第一行代码》学习笔记.html-4qTqfstM.js" as="script"><link rel="prefetch" href="/assets/Linux服务器编程.html-DdOFSgf8.js" as="script"><link rel="prefetch" href="/assets/VS修改编码格式为UTF-8.html-B09kQg0y.js" as="script"><link rel="prefetch" href="/assets/vs未能正确加载XX包的解决方法.html-BDNXqc0Z.js" as="script"><link rel="prefetch" href="/assets/易道云学习笔记.html-1SQjfoSl.js" as="script"><link rel="prefetch" href="/assets/Git学习笔记.html-nAbOwkOm.js" as="script"><link rel="prefetch" href="/assets/Java加密库的签名问题解决记录.html-BqHklMmz.js" as="script"><link rel="prefetch" href="/assets/《疯狂JAVA讲义》学习笔记.html-C475dxkO.js" as="script"><link rel="prefetch" href="/assets/动力节点NIO学习笔记.html-DpSIy37U.js" as="script"><link rel="prefetch" href="/assets/SSH服务与VS连接失败解决方案.html-C_NDNbwo.js" as="script"><link rel="prefetch" href="/assets/易道云-Linux系统命令.html-DJkF5rLi.js" as="script"><link rel="prefetch" href="/assets/狂神说Linux.html-90svuYwT.js" as="script"><link rel="prefetch" href="/assets/Docker学习笔记.html-BrT0bAXa.js" as="script"><link rel="prefetch" href="/assets/Docker部署前后端项目.html-DE9Qz6Lw.js" as="script"><link rel="prefetch" href="/assets/ElasticSearch学习笔记.html-DluTW_Wu.js" as="script"><link rel="prefetch" href="/assets/Redis学习笔记.html-B6Ki7NUN.js" as="script"><link rel="prefetch" href="/assets/CSDN转为Markdown.html-CRp20XzA.js" as="script"><link rel="prefetch" href="/assets/栈溢出漏洞原理详解与利用.html-B2oRwBUa.js" as="script"><link rel="prefetch" href="/assets/FridaHook学习笔记.html-DmubdPzU.js" as="script"><link rel="prefetch" href="/assets/Windows Defender强制卸载.html-BE7MXLKa.js" as="script"><link rel="prefetch" href="/assets/404.html-iozy3Grn.js" as="script"><link rel="prefetch" href="/assets/index.html-T2jvYbfg.js" as="script"><link rel="prefetch" href="/assets/Friend-C2B5yfqj.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container no-sidebar"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="logo" src="https://wqby-1304194722.cos.ap-nanjing.myqcloud.com/img/b_9523abbb426ea0c8a21b2754fdc52300.jpg" alt="不良人"><span class="site-name can-hide" aria-hidden="true">不良人</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="route-link" href="/" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="学习"><span class="title">学习</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="学习"><span class="title">学习</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/view/note/" aria-label="学习笔记"><!--[--><!--]--> 学习笔记 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="route-link" href="/view/pigeonhole/" aria-label="归档"><!--[--><!--]--> 归档 <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/view/work/" aria-label="作品"><!--[--><!--]--> 作品 <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/view/about/" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="route-link" href="/" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="学习"><span class="title">学习</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="学习"><span class="title">学习</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/view/note/" aria-label="学习笔记"><!--[--><!--]--> 学习笔记 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="route-link" href="/view/pigeonhole/" aria-label="归档"><!--[--><!--]--> 归档 <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/view/work/" aria-label="作品"><!--[--><!--]--> 作品 <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/view/about/" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="最低成本的方式搭建chatgpt接口" tabindex="-1"><a class="header-anchor" href="#最低成本的方式搭建chatgpt接口"><span>最低成本的方式搭建ChatGpt接口</span></a></h1><blockquote><p>2023-11-02补充：如今国内的文心一言等AI模型已经公开并且盛行，已经可以在国内直接调用了，没必要像下文那样去使用chatgpt了，本文旨在提供调用外网正版chatgpt接口的思路。</p></blockquote><p>首先我们先要通过挂梯子(翻墙)访问到openai官网，然后拿到自己调用接口的key，此步直接省略。</p><p>假设你的key为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（请勿泄露给别人）</p><h2 id="初次试错" tabindex="-1"><a class="header-anchor" href="#初次试错"><span>初次试错</span></a></h2><p>接下来我们就要对需求进行分析，因为接口必须翻墙才可以访问，所以按照大家惯性思维去搭建这个后端接口的话，都是采用任一编程语言实现一段http接口操作，然后运行到服务器上后，并且给服务器挂上梯子，再通过前端对这个接口进行访问。</p><p>于是我便开始了这第一种方法的尝试，这里我使用的是Nodejs语言的Express实现了一个简易的后端接口进行测试。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;body-parser&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;cors&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定义GET请求的路由</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/ask&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> question <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>question<span class="token punctuation">;</span>

    <span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&#39;method&#39;</span><span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&#39;url&#39;</span><span class="token operator">:</span> <span class="token string">&#39;https://api.openai.com/v1/chat/completions&#39;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&#39;headers&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&#39;Authorization&#39;</span><span class="token operator">:</span> <span class="token string">&#39;Bearer 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&#39;</span><span class="token punctuation">,</span><span class="token comment">//这里替换成自己的key</span>
            <span class="token string-property property">&#39;User-Agent&#39;</span><span class="token operator">:</span> <span class="token string">&#39;Apifox/1.0.0 (https://www.apifox.cn)&#39;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&#39;Content-Type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;application/json&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{
            &quot;model&quot;: &quot;gpt-3.5-turbo&quot;,
            &quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>question<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;}]
        }</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 启动服务器</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Server started on port 3000&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>与此同时我将本机开启了全局翻墙，但我经过测试接口发现会引发超时错误。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">Error</span><span class="token operator">:</span> Error<span class="token operator">:</span> connect <span class="token constant">ETIMEDOUT</span> <span class="token number">104.23</span><span class="token number">.125</span><span class="token number">.189</span><span class="token operator">:</span><span class="token number">443</span>
    at Request<span class="token punctuation">.</span><span class="token function">_callback</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token operator">:</span>\Users\Administrator\Desktop\gptinterface\test<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">30</span><span class="token operator">:</span><span class="token number">26</span><span class="token punctuation">)</span>
    at self<span class="token punctuation">.</span><span class="token function">callback</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token operator">:</span>\Users\Administrator\Desktop\gptinterface\node_modules\request\request<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">185</span><span class="token operator">:</span><span class="token number">22</span><span class="token punctuation">)</span>
    at Request<span class="token punctuation">.</span><span class="token function">emit</span> <span class="token punctuation">(</span>node<span class="token operator">:</span>events<span class="token operator">:</span><span class="token number">513</span><span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">)</span>
    at Request<span class="token punctuation">.</span><span class="token function">onRequestError</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token operator">:</span>\Users\Administrator\Desktop\gptinterface\node_modules\request\request<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">877</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span>
    at ClientRequest<span class="token punctuation">.</span><span class="token function">emit</span> <span class="token punctuation">(</span>node<span class="token operator">:</span>events<span class="token operator">:</span><span class="token number">513</span><span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">)</span>
    at TLSSocket<span class="token punctuation">.</span><span class="token function">socketErrorListener</span> <span class="token punctuation">(</span>node<span class="token operator">:</span>_http_client<span class="token operator">:</span><span class="token number">502</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">)</span>
    at TLSSocket<span class="token punctuation">.</span><span class="token function">emit</span> <span class="token punctuation">(</span>node<span class="token operator">:</span>events<span class="token operator">:</span><span class="token number">513</span><span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">)</span>
    at <span class="token function">emitErrorNT</span> <span class="token punctuation">(</span>node<span class="token operator">:</span>internal<span class="token operator">/</span>streams<span class="token operator">/</span>destroy<span class="token operator">:</span><span class="token number">151</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span>
    at <span class="token function">emitErrorCloseNT</span> <span class="token punctuation">(</span>node<span class="token operator">:</span>internal<span class="token operator">/</span>streams<span class="token operator">/</span>destroy<span class="token operator">:</span><span class="token number">116</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>
    at process<span class="token punctuation">.</span><span class="token function">processTicksAndRejections</span> <span class="token punctuation">(</span>node<span class="token operator">:</span>internal<span class="token operator">/</span>process<span class="token operator">/</span>task_queues<span class="token operator">:</span><span class="token number">82</span><span class="token operator">:</span><span class="token number">21</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>于是通过API工具调用接口进行尝试，一样引发了超时错误。</p><p>这里可以推测出原因，系统虽然实现了翻墙，但是代码并没有走系统代理，于是我便对API工具设置了系统代理。</p><p><img src="https://wqby-1304194722.cos.ap-nanjing.myqcloud.com/img/image-20230503143835318.png" alt="image-20230503143835318"></p><p>然后再次访问测试，得到了我想要的结果。</p><p><img src="https://wqby-1304194722.cos.ap-nanjing.myqcloud.com/img/image-20230503143959381.png" alt="image-20230503143959381"></p><p>知道了原因，那么我们还要想办法对代码实现系统代理，这里就比较复杂了，况且就算实现后，我们还要自备服务器和翻墙软件，然后将其跑在自己的服务器上，成本很高，并且要挂梯子，很复杂，所以我便直接放弃了这个方案。</p><h2 id="步入正轨" tabindex="-1"><a class="header-anchor" href="#步入正轨"><span>步入正轨</span></a></h2><p>下面给大家推荐一个终极解决方案</p><blockquote><p>使用云函数对openai接口进行访问</p></blockquote><p>知名云计算平台，例如阿里云、腾讯云、华为云，都有云函数的支持，我们只需要将云函数的地区设置到美国或者其他Openai支持的国家，就可以实现免翻墙直接访问接口。</p><p>这里要感谢云计算为我们个人开发者或者中小企业带来的便利。 接下来详细的介绍一下云函数的使用方法及代码编写，这里以<strong>腾讯云</strong>为例。</p><h3 id="_1-新建云函数" tabindex="-1"><a class="header-anchor" href="#_1-新建云函数"><span>1.新建云函数</span></a></h3><p><img src="https://wqby-1304194722.cos.ap-nanjing.myqcloud.com/img/image-20230503144910978.png" alt="image-20230503144910978"></p><p>选择从头开始，运行环境根据自己的编程语言来，这里以Nodejs为例。</p><p>函数代码如下：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">)</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">main_handler</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">var</span> question <span class="token operator">=</span> event<span class="token punctuation">.</span>queryString<span class="token punctuation">.</span>question<span class="token punctuation">;</span>
<span class="token keyword">var</span> answer <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
   <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">60000</span><span class="token punctuation">,</span>
			<span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
			<span class="token literal-property property">uri</span><span class="token operator">:</span> <span class="token string">&#39;https://api.openai.com/v1/chat/completions&#39;</span><span class="token punctuation">,</span>
			<span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token string-property property">&quot;content-type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&#39;Authorization&#39;</span><span class="token operator">:</span> <span class="token string">&#39;Bearer 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&#39;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				<span class="token string-property property">&quot;model&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gpt-3.5-turbo&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;messages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;content&quot;</span><span class="token operator">:</span> question<span class="token punctuation">}</span><span class="token punctuation">]</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> response<span class="token punctuation">,</span> body</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			answer <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span>choices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>message<span class="token punctuation">.</span>content
			<span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> answer<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样，该云函数就实现了读取question参数并访问openai接口，然后返回chatgpt机器人回复内容的功能。</p><p>正常云函数是通过定时触发的，因为我们要通过http主动访问这个云函数，所以要创建一个API网关触发器而不是定时触发器。</p><p><img src="https://wqby-1304194722.cos.ap-nanjing.myqcloud.com/img/image-20230503145445929.png" alt="image-20230503145445929"></p><p>还有最后一个异常重要的地方要进行设置，因为ChatGpt接口调用有时延，有的时候机器人需要数十秒才可以回应我们的请求，所以要设置超时长一点，这里设置成60s。</p><p><img src="https://wqby-1304194722.cos.ap-nanjing.myqcloud.com/img/image-20230503152125364.png" alt="image-20230503152125364"></p><p>至此，所有环境配置完毕，点击完成即可。</p><h3 id="_2-安装依赖" tabindex="-1"><a class="header-anchor" href="#_2-安装依赖"><span>2.安装依赖</span></a></h3><p>刚刚只是编写了js代码，但是依赖库还没有安装，所以我们要先去安装函数依赖。只用到了request一个包，只需要安装这一个就可以了。</p><p><img src="https://wqby-1304194722.cos.ap-nanjing.myqcloud.com/img/image-20230503145614838.png" alt="image-20230503145614838"></p><p>首先点击终端-新建终端</p><p>我们可以看到index.js在src目录里，所以步骤如下：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> src
<span class="token function">npm</span> <span class="token function">install</span> request
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://wqby-1304194722.cos.ap-nanjing.myqcloud.com/img/image-20230503145833960.png" alt="image-20230503145833960"></p><p>执行完毕后就多出来了一堆依赖文件，至此我们的云函数就算是编写完毕了，点击部署按钮，即可上传云函数成功。</p><h3 id="_3-查看访问url" tabindex="-1"><a class="header-anchor" href="#_3-查看访问url"><span>3.查看访问url</span></a></h3><p>切换到触发管理界面，找到刚刚我们创建的API网关触发的访问路径，将其复制下来。</p><p>https://service-2ruclnmk-1304194722.usw.apigw.tencentcs.com/release/chatgpt</p><p>这里要去掉release才是真正的访问路径</p><p>https://service-2ruclnmk-1304194722.usw.apigw.tencentcs.com/chatgpt</p><p>我们再对question参数进行拼接</p><p>https://service-2ruclnmk-1304194722.usw.apigw.tencentcs.com/chatgpt?question=你好，我是帅哥</p><p>这里question便是我们自定义的问题了，通过get请求或者直接浏览器访问即可实现chatgpt接口的云函数调用。</p><p><img src="https://wqby-1304194722.cos.ap-nanjing.myqcloud.com/img/image-20230503150348750.png" alt="image-20230503150348750"></p><p>至此，我们的功能便彻底实现完成。</p><p>云函数首次使用应该会赠送免费的使用额度，使用完免费额度后，是按量付费的，成本很低，要记住往腾讯云里充值一些余额，以防欠费后无法调用。</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 9479421@qq.com">wqby</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-C2hHG5A5.js" defer></script>
  </body>
</html>
